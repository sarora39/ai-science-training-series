/home/shikhararora/miniconda3/envs/groqflow/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
[93m
Warning: [0m[0mbuild_model() discovered a cached build of bert_tiny_custom, but decided to rebuild for the following reasons: [0m
[0m         [0m[0m[0m
[0m         [0m[0m- Input shape of model "bert_tiny_custom" changed from {'attention_mask': (10, 256), 'input_ids': (10, 256)} to {'attention_mask': (1, 256), 'input_ids': (1, 256)} since the last time it was built. [0m
[0m         [0m[0m[0m
[0m         [0m[0mbuild_model() will now rebuild your model to ensure correctness. You can change this policy by setting the build_model(rebuild=...) argument.[0m



[1mBuilding "bert_tiny_custom"[0m
[0m      Exporting PyTorch to ONNX   [0m
[0m      Optimizing ONNX file   [0m
[0m      Checking for Op support   [0m
[0m      Converting to FP16   [0m
[0m      Compiling model   [0m
[0m      Assembling model   [0m
[1A[1A[1A[1A[1A[1A[92m    ✓ [0m[0mExporting PyTorch to ONNX   [0m
[92m    ✓ [0m[0mOptimizing ONNX file   [0m
      Checking for Op support         Checking for Op support.        Checking for Op support..       Checking for Op support...[92m    ✓ [0m[0mChecking for Op support   [0m
[92m    ✓ [0m[0mConverting to FP16   [0m
      Compiling model         Compiling model.        Compiling model..       Compiling model...      Compiling model         Compiling model.        Compiling model..       Compiling model...      Compiling model         Compiling model.        Compiling model..       Compiling model...      Compiling model         Compiling model.        Compiling model..       Compiling model...      Compiling model         Compiling model.        Compiling model.. [92m    ✓ [0m[0mCompiling model   [0m
      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...      Assembling model         Assembling model.        Assembling model..       Assembling model...[92m    ✓ [0m[0mAssembling model   [0m
[92m
Woohoo! [0m[0mSaved to [0m[1m~/.cache/groqflow/bert_tiny_custom[0m[0m[0m
/home/shikhararora/miniconda3/envs/groqflow/lib/python3.10/site-packages/datasets/load.py:1461: FutureWarning: The repository for sst contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/sst
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
Preprocessing data.
[96m
Info: [0m[0mNo inputs received for benchmark. Using the inputs provided during model compilation.[0m
Running inference on GroqChip.
Running inference using PyTorch model (CPU).
  0%|          | 0/2210 [00:00<?, ?it/s]  1%|          | 21/2210 [00:00<00:10, 203.20it/s]  2%|▏         | 46/2210 [00:00<00:09, 228.09it/s]  3%|▎         | 71/2210 [00:00<00:09, 237.62it/s]  4%|▍         | 96/2210 [00:00<00:08, 239.21it/s]  5%|▌         | 121/2210 [00:00<00:08, 241.95it/s]  7%|▋         | 146/2210 [00:00<00:08, 243.29it/s]  8%|▊         | 171/2210 [00:00<00:08, 243.71it/s]  9%|▉         | 196/2210 [00:00<00:08, 243.84it/s] 10%|█         | 221/2210 [00:00<00:08, 244.51it/s] 11%|█         | 246/2210 [00:01<00:08, 244.50it/s] 12%|█▏        | 271/2210 [00:01<00:07, 244.77it/s] 13%|█▎        | 296/2210 [00:01<00:07, 242.48it/s] 15%|█▍        | 321/2210 [00:01<00:07, 241.87it/s] 16%|█▌        | 346/2210 [00:01<00:07, 241.69it/s] 17%|█▋        | 371/2210 [00:01<00:07, 242.86it/s] 18%|█▊        | 396/2210 [00:01<00:07, 242.84it/s] 19%|█▉        | 421/2210 [00:01<00:07, 242.51it/s] 20%|██        | 446/2210 [00:01<00:07, 242.98it/s] 21%|██▏       | 471/2210 [00:01<00:07, 243.51it/s] 22%|██▏       | 496/2210 [00:02<00:07, 243.82it/s] 24%|██▎       | 521/2210 [00:02<00:06, 244.71it/s] 25%|██▍       | 546/2210 [00:02<00:06, 245.68it/s] 26%|██▌       | 571/2210 [00:02<00:06, 243.83it/s] 27%|██▋       | 596/2210 [00:02<00:06, 243.86it/s] 28%|██▊       | 621/2210 [00:02<00:06, 244.40it/s] 29%|██▉       | 646/2210 [00:02<00:06, 245.06it/s] 30%|███       | 671/2210 [00:02<00:06, 245.13it/s] 31%|███▏      | 696/2210 [00:02<00:06, 243.74it/s] 33%|███▎      | 721/2210 [00:02<00:06, 243.83it/s] 34%|███▍      | 746/2210 [00:03<00:06, 243.39it/s] 35%|███▍      | 771/2210 [00:03<00:05, 243.96it/s] 36%|███▌      | 796/2210 [00:03<00:05, 244.35it/s] 37%|███▋      | 821/2210 [00:03<00:05, 244.03it/s] 38%|███▊      | 846/2210 [00:03<00:05, 242.15it/s] 39%|███▉      | 871/2210 [00:03<00:05, 240.99it/s] 41%|████      | 896/2210 [00:03<00:05, 240.95it/s] 42%|████▏     | 921/2210 [00:03<00:05, 241.45it/s] 43%|████▎     | 946/2210 [00:03<00:05, 240.63it/s] 44%|████▍     | 971/2210 [00:04<00:05, 240.96it/s] 45%|████▌     | 996/2210 [00:04<00:05, 242.04it/s] 46%|████▌     | 1021/2210 [00:04<00:04, 242.93it/s] 47%|████▋     | 1046/2210 [00:04<00:04, 242.64it/s] 48%|████▊     | 1071/2210 [00:04<00:04, 242.46it/s] 50%|████▉     | 1096/2210 [00:04<00:04, 243.02it/s] 51%|█████     | 1121/2210 [00:04<00:04, 243.86it/s] 52%|█████▏    | 1146/2210 [00:04<00:04, 242.40it/s] 53%|█████▎    | 1171/2210 [00:04<00:04, 242.73it/s] 54%|█████▍    | 1196/2210 [00:04<00:04, 243.64it/s] 55%|█████▌    | 1221/2210 [00:05<00:04, 243.72it/s] 56%|█████▋    | 1246/2210 [00:05<00:03, 243.90it/s] 58%|█████▊    | 1271/2210 [00:05<00:03, 243.99it/s] 59%|█████▊    | 1296/2210 [00:05<00:03, 243.91it/s] 60%|█████▉    | 1321/2210 [00:05<00:03, 242.50it/s] 61%|██████    | 1346/2210 [00:05<00:03, 237.11it/s] 62%|██████▏   | 1371/2210 [00:05<00:03, 240.42it/s] 63%|██████▎   | 1396/2210 [00:05<00:03, 241.08it/s] 64%|██████▍   | 1421/2210 [00:05<00:03, 242.12it/s] 65%|██████▌   | 1446/2210 [00:05<00:03, 243.74it/s] 67%|██████▋   | 1471/2210 [00:06<00:03, 243.96it/s] 68%|██████▊   | 1496/2210 [00:06<00:02, 244.79it/s] 69%|██████▉   | 1521/2210 [00:06<00:02, 245.48it/s] 70%|██████▉   | 1546/2210 [00:06<00:02, 245.61it/s] 71%|███████   | 1571/2210 [00:06<00:02, 245.71it/s] 72%|███████▏  | 1596/2210 [00:06<00:02, 246.11it/s] 73%|███████▎  | 1621/2210 [00:06<00:02, 246.34it/s] 74%|███████▍  | 1646/2210 [00:06<00:02, 246.94it/s] 76%|███████▌  | 1671/2210 [00:06<00:02, 244.80it/s] 77%|███████▋  | 1696/2210 [00:06<00:02, 245.60it/s] 78%|███████▊  | 1721/2210 [00:07<00:01, 246.79it/s] 79%|███████▉  | 1746/2210 [00:07<00:01, 246.39it/s] 80%|████████  | 1771/2210 [00:07<00:01, 246.51it/s] 81%|████████▏ | 1796/2210 [00:07<00:01, 246.24it/s] 82%|████████▏ | 1821/2210 [00:07<00:01, 246.94it/s] 84%|████████▎ | 1846/2210 [00:07<00:01, 246.61it/s] 85%|████████▍ | 1871/2210 [00:07<00:01, 246.90it/s] 86%|████████▌ | 1896/2210 [00:07<00:01, 246.57it/s] 87%|████████▋ | 1921/2210 [00:07<00:01, 246.47it/s] 88%|████████▊ | 1946/2210 [00:07<00:01, 246.98it/s] 89%|████████▉ | 1971/2210 [00:08<00:00, 247.76it/s] 90%|█████████ | 1996/2210 [00:08<00:00, 247.60it/s] 91%|█████████▏| 2021/2210 [00:08<00:00, 246.86it/s] 93%|█████████▎| 2046/2210 [00:08<00:00, 246.45it/s] 94%|█████████▎| 2071/2210 [00:08<00:00, 245.63it/s] 95%|█████████▍| 2096/2210 [00:08<00:00, 244.40it/s] 96%|█████████▌| 2121/2210 [00:08<00:00, 244.25it/s] 97%|█████████▋| 2146/2210 [00:08<00:00, 244.46it/s] 98%|█████████▊| 2171/2210 [00:08<00:00, 244.68it/s] 99%|█████████▉| 2196/2210 [00:09<00:00, 244.47it/s]100%|██████████| 2210/2210 [00:09<00:00, 243.73it/s]
+--------+----------+-------------------------+----------------+----------------------+-------------+
| Source | Accuracy | end-to-end latency (ms) | end-to-end IPS | on-chip latency (ms) | on-chip IPS |
+--------+----------+-------------------------+----------------+----------------------+-------------+
|  cpu   |  77.47%  |           4.10          |     243.63     |          --          |      --     |
|  groq  |  77.47%  |           0.08          |    12762.62    |         0.04         |   23391.20  |
+--------+----------+-------------------------+----------------+----------------------+-------------+
Proof point /home/shikhararora/groqflow/proof_points/natural_language_processing/bert/bert_tiny_custom.py finished!
